<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iBreakDown plots for Sinking of the RMS Titanic • iBreakDown</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top navbar-mi2" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-mi2logo" href="http://mi2.mini.pw.edu.pl/">
        <img src="https://github.com/mi2-warsaw/MI2template/blob/master/inst/pkgdown/assets/MI2logo.jpg?raw=true" alt="MI2" height="46" title="MI2"></a>
      <a class="navbar-brand navbar-mi2" href="../index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="navbar-mi2 nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette_iBreakDown_classification.html">iBreakDown plots for classification models</a>
    </li>
    <li>
      <a href="../articles/vignette_iBreakDown_regression.html">iBreakDown plots for regression models</a>
    </li>
    <li>
      <a href="../articles/vignette_iBreakDown_titanic.html">iBreakDown plots for Sinking of the RMS Titanic</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="vignette_iBreakDown_titanic_files/htmlwidgets-1.3/htmlwidgets.js"></script><script src="vignette_iBreakDown_titanic_files/r2d3-render-0.1.0/r2d3-render.js"></script><script src="vignette_iBreakDown_titanic_files/webcomponents-2.0.0/webcomponents.js"></script><script src="vignette_iBreakDown_titanic_files/r2d3-binding-0.2.3/r2d3.js"></script><script src="vignette_iBreakDown_titanic_files/d3v4-4.13.0/d3.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>iBreakDown plots for Sinking of the RMS Titanic</h1>
                        <h4 class="author">Przemyslaw Biecek</h4>
            
            <h4 class="date">2019-03-16</h4>
      
      
      <div class="hidden name"><code>vignette_iBreakDown_titanic.Rmd</code></div>

    </div>

    
    
<div id="data-for-titanic-survival" class="section level1">
<h1 class="hasAnchor">
<a href="#data-for-titanic-survival" class="anchor"></a>Data for Titanic survival</h1>
<p>Let’s see an example for <code>iBreakDown</code> plots for survival probability of Titanic passengers. First, let’s see the data, we will find quite nice data from in the <code>DALEX</code> package (orginally <code>stablelearner</code>).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(<span class="st">"DALEX"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">head</span>(titanic)</a></code></pre></div>
<pre><code>#&gt;   gender age class    embarked       country  fare sibsp parch survived
#&gt; 1   male  42   3rd Southampton United States  7.11     0     0       no
#&gt; 2   male  13   3rd Southampton United States 20.05     0     2       no
#&gt; 3   male  16   3rd Southampton United States 20.05     1     1       no
#&gt; 4 female  39   3rd Southampton       England 20.05     1     1      yes
#&gt; 5 female  16   3rd Southampton        Norway  7.13     0     0      yes
#&gt; 6   male  25   3rd Southampton United States  7.13     0     0      yes</code></pre>
</div>
<div id="model-for-titanic-survival" class="section level1">
<h1 class="hasAnchor">
<a href="#model-for-titanic-survival" class="anchor"></a>Model for Titanic survival</h1>
<p>Ok, now it’s time to create a model. Let’s use the Random Forest model.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># prepare model</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">library</span>(<span class="st">"randomForest"</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">titanic &lt;-<span class="st"> </span><span class="kw">na.omit</span>(titanic)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">model_titanic_rf &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/randomForest/topics/randomForest">randomForest</a></span>(survived <span class="op">==</span><span class="st"> "yes"</span> <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>class <span class="op">+</span><span class="st"> </span>embarked <span class="op">+</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">                                   </span>fare <span class="op">+</span><span class="st"> </span>sibsp <span class="op">+</span><span class="st"> </span>parch,  <span class="dt">data =</span> titanic)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">model_titanic_rf</a></code></pre></div>
<pre><code>#&gt; 
#&gt; Call:
#&gt;  randomForest(formula = survived == "yes" ~ gender + age + class +      embarked + fare + sibsp + parch, data = titanic) 
#&gt;                Type of random forest: regression
#&gt;                      Number of trees: 500
#&gt; No. of variables tried at each split: 2
#&gt; 
#&gt;           Mean of squared residuals: 0.1432603
#&gt;                     % Var explained: 34.64</code></pre>
</div>
<div id="explainer-for-titanic-survival" class="section level1">
<h1 class="hasAnchor">
<a href="#explainer-for-titanic-survival" class="anchor"></a>Explainer for Titanic survival</h1>
<p>The third step (it’s optional but useful) is to create a DALEX explainer for Random Forest model.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">library</span>(<span class="st">"DALEX"</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">explain_titanic_rf &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/DALEX/topics/explain">explain</a></span>(model_titanic_rf, </a>
<a class="sourceLine" id="cb5-3" data-line-number="3">                      <span class="dt">data =</span> titanic[,<span class="op">-</span><span class="dv">9</span>],</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">                      <span class="dt">y =</span> titanic<span class="op">$</span>survived <span class="op">==</span><span class="st"> "yes"</span>, </a>
<a class="sourceLine" id="cb5-5" data-line-number="5">                      <span class="dt">label =</span> <span class="st">"Random Forest v7"</span>)</a></code></pre></div>
</div>
<div id="break-down-plot-with-d3" class="section level1">
<h1 class="hasAnchor">
<a href="#break-down-plot-with-d3" class="anchor"></a>Break Down plot with D3</h1>
<p>Let’s see Break Down for model predictions for 8 years old male from 1st class that embarked from port C.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">new_passanger &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">  <span class="dt">class =</span> <span class="kw">factor</span>(<span class="st">"1st"</span>, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">"1st"</span>, <span class="st">"2nd"</span>, <span class="st">"3rd"</span>, <span class="st">"deck crew"</span>, <span class="st">"engineering crew"</span>, <span class="st">"restaurant staff"</span>, <span class="st">"victualling crew"</span>)),</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  <span class="dt">gender =</span> <span class="kw">factor</span>(<span class="st">"male"</span>, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>)),</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  <span class="dt">age =</span> <span class="dv">8</span>,</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  <span class="dt">sibsp =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  <span class="dt">parch =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">  <span class="dt">fare =</span> <span class="dv">72</span>,</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">  <span class="dt">embarked =</span> <span class="kw">factor</span>(<span class="st">"Southampton"</span>, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">"Belfast"</span>, <span class="st">"Cherbourg"</span>, <span class="st">"Queenstown"</span>, <span class="st">"Southampton"</span>))</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">)</a></code></pre></div>
<div id="calculate-variable-attributions" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-variable-attributions" class="anchor"></a>Calculate variable attributions</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(<span class="st">"iBreakDown"</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">rf_la &lt;-<span class="st"> </span><span class="kw"><a href="../reference/local_attributions.html">local_attributions</a></span>(explain_titanic_rf, new_passanger)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">rf_la</a></code></pre></div>
<pre><code>#&gt;                                          contribution
#&gt; Random Forest v7: intercept                     0.324
#&gt; Random Forest v7: age = 8                       0.194
#&gt; Random Forest v7: class = 1st                   0.066
#&gt; Random Forest v7: gender = male                -0.058
#&gt; Random Forest v7: fare = 72                    -0.058
#&gt; Random Forest v7: embarked = Southampton       -0.022
#&gt; Random Forest v7: sibsp = 0                    -0.006
#&gt; Random Forest v7: parch = 0                    -0.028
#&gt; Random Forest v7: prediction                    0.412</code></pre>
</div>
<div id="plot-attributions-with-ggplot2" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-attributions-with-ggplot2" class="anchor"></a>Plot attributions with <code>ggplot2</code>
</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">plot</span>(rf_la)</a></code></pre></div>
<p><img src="vignette_iBreakDown_titanic_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div id="plot-attributions-with-d3" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-attributions-with-d3" class="anchor"></a>Plot attributions with <code>D3</code>
</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/plotD3.html">plotD3</a></span>(rf_la)</a></code></pre></div>
<div id="htmlwidget-e9e828b9d3fb3ac93cd3" style="width:672px;height:336px;" class="r2d3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-e9e828b9d3fb3ac93cd3">{"x":{"data":[{"variable":"age = 8","contribution":0.193943226485464,"cummulative":0.518189722895281,"sign":"#8bdcbe","label":"age = 8<br>increases average response <br>by 0.194"},{"variable":"class = 1st","contribution":0.0664084814300531,"cummulative":0.584598204325334,"sign":"#8bdcbe","label":"class = 1st<br>increases average response <br>by 0.066"},{"variable":"gender = male","contribution":-0.0577068226595366,"cummulative":0.526891381665797,"sign":"#f05a71","label":"gender = male<br>decreases average response <br>by 0.058"},{"variable":"fare = 72","contribution":-0.0584582591729485,"cummulative":0.468433122492849,"sign":"#f05a71","label":"fare = 72<br>decreases average response <br>by 0.058"},{"variable":"embarked = Southampton","contribution":-0.0220198092932771,"cummulative":0.446413313199572,"sign":"#f05a71","label":"embarked = Southampton<br>decreases average response <br>by 0.022"},{"variable":"sibsp = 0","contribution":-0.00644377946718533,"cummulative":0.439969533732387,"sign":"#f05a71","label":"sibsp = 0<br>decreases average response <br>by 0.006"},{"variable":"parch = 0","contribution":-0.0283848946862266,"cummulative":0.41158463904616,"sign":"#f05a71","label":"parch = 0<br>decreases average response <br>by 0.028"}],"type":"list","container":"svg","options":{"xmin":0.3078,"xmax":0.613828114541601,"model_avg":0.324,"model_res":0.412},"script":"var d3Script = function(d3, r2d3, data, svg, width, height, options, theme, console) {\nthis.d3 = d3;\n/* R2D3 Source File:  /Library/Frameworks/R.framework/Versions/3.5/Resources/library/iBreakDown/tooltipD3.js */\n// TOOLTIP\n\n// d3.tip\n// Copyright (c) 2013 Justin Palmer\n// ES6 / D3 v4 Adaption Copyright (c) 2016 Constantin Gavrilete\n// Removal of ES6 for D3 v4 Adaption Copyright (c) 2016 David Gotz\n//\n// Tooltips for d3.js SVG visualizations\nd3.functor = function functor(v) {\n  return typeof v === \"function\" ? v : function() {\n    return v;\n  };\n};\n\nd3.tip = function() {\n\n  var direction = d3_tip_direction,\n      offset    = d3_tip_offset,\n      html      = d3_tip_html,\n      node      = initNode(),\n      svg       = null,\n      point     = null,\n      target    = null\n\n  function tip(vis) {\n    svg = getSVGNode(vis)\n    point = svg.createSVGPoint()\n    document.body.appendChild(node)\n  }\n\n  // Public - show the tooltip on the screen\n  //\n  // Returns a tip\n  tip.show = function() {\n    var args = Array.prototype.slice.call(arguments)\n    if(args[args.length - 1] instanceof SVGElement) target = args.pop()\n\n    var content = html.apply(this, args),\n        poffset = offset.apply(this, args),\n        dir     = direction.apply(this, args),\n        nodel   = getNodeEl(),\n        i       = directions.length,\n        coords,\n        scrollTop  = document.documentElement.scrollTop || document.body.scrollTop,\n        scrollLeft = document.documentElement.scrollLeft || document.body.scrollLeft\n\n    nodel.html(content)\n      .style('position', 'absolute')\n      .style('opacity', 1)\n      .style('pointer-events', 'all')\n\n    while(i--) nodel.classed(directions[i], false)\n    coords = direction_callbacks[dir].apply(this)\n    nodel.classed(dir, true)\n      .style('top', (coords.top +  poffset[0]) + scrollTop + 'px')\n      .style('left', (coords.left + poffset[1]) + scrollLeft + 'px')\n\n    return tip\n  }\n\n  // Public - hide the tooltip\n  //\n  // Returns a tip\n  tip.hide = function() {\n    var nodel = getNodeEl()\n    nodel\n      .style('opacity', 0)\n      .style('pointer-events', 'none')\n    return tip\n  }\n\n  // Public: Proxy attr calls to the d3 tip container.  Sets or gets attribute value.\n  //\n  // n - name of the attribute\n  // v - value of the attribute\n  //\n  // Returns tip or attribute value\n  tip.attr = function(n, v) {\n    if (arguments.length < 2 && typeof n === 'string') {\n      return getNodeEl().attr(n)\n    } else {\n      var args =  Array.prototype.slice.call(arguments)\n      d3.selection.prototype.attr.apply(getNodeEl(), args)\n    }\n\n    return tip\n  }\n\n  // Public: Proxy style calls to the d3 tip container.  Sets or gets a style value.\n  //\n  // n - name of the property\n  // v - value of the property\n  //\n  // Returns tip or style property value\n  tip.style = function(n, v) {\n    // debugger;\n    if (arguments.length < 2 && typeof n === 'string') {\n      return getNodeEl().style(n)\n    } else {\n      var args = Array.prototype.slice.call(arguments);\n      if (args.length === 1) {\n        var styles = args[0];\n        Object.keys(styles).forEach(function(key) {\n          return d3.selection.prototype.style.apply(getNodeEl(), [key, styles[key]]);\n        });\n      }\n    }\n\n    return tip\n  }\n\n  // Public: Set or get the direction of the tooltip\n  //\n  // v - One of n(north), s(south), e(east), or w(west), nw(northwest),\n  //     sw(southwest), ne(northeast) or se(southeast)\n  //\n  // Returns tip or direction\n  tip.direction = function(v) {\n    if (!arguments.length) return direction\n    direction = v == null ? v : d3.functor(v)\n\n    return tip\n  }\n\n  // Public: Sets or gets the offset of the tip\n  //\n  // v - Array of [x, y] offset\n  //\n  // Returns offset or\n  tip.offset = function(v) {\n    if (!arguments.length) return offset\n    offset = v == null ? v : d3.functor(v)\n\n    return tip\n  }\n\n  // Public: sets or gets the html value of the tooltip\n  //\n  // v - String value of the tip\n  //\n  // Returns html value or tip\n  tip.html = function(v) {\n    if (!arguments.length) return html\n    html = v == null ? v : d3.functor(v)\n\n    return tip\n  }\n\n  // Public: destroys the tooltip and removes it from the DOM\n  //\n  // Returns a tip\n  tip.destroy = function() {\n    if(node) {\n      getNodeEl().remove();\n      node = null;\n    }\n    return tip;\n  }\n\n  function d3_tip_direction() { return 'n' }\n  function d3_tip_offset() { return [0, 0] }\n  function d3_tip_html() { return ' ' }\n\n  var direction_callbacks = {\n    n:  direction_n,\n    s:  direction_s,\n    e:  direction_e,\n    w:  direction_w,\n    nw: direction_nw,\n    ne: direction_ne,\n    sw: direction_sw,\n    se: direction_se\n  };\n\n  var directions = Object.keys(direction_callbacks);\n\n  function direction_n() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.n.y - node.offsetHeight,\n      left: bbox.n.x - node.offsetWidth / 2\n    }\n  }\n\n  function direction_s() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.s.y,\n      left: bbox.s.x - node.offsetWidth / 2\n    }\n  }\n\n  function direction_e() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.e.y - node.offsetHeight / 2,\n      left: bbox.e.x\n    }\n  }\n\n  function direction_w() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.w.y - node.offsetHeight / 2,\n      left: bbox.w.x - node.offsetWidth\n    }\n  }\n\n  function direction_nw() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.nw.y - node.offsetHeight,\n      left: bbox.nw.x - node.offsetWidth\n    }\n  }\n\n  function direction_ne() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.ne.y - node.offsetHeight,\n      left: bbox.ne.x\n    }\n  }\n\n  function direction_sw() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.sw.y,\n      left: bbox.sw.x - node.offsetWidth\n    }\n  }\n\n  function direction_se() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.se.y,\n      left: bbox.e.x\n    }\n  }\n\n  function initNode() {\n    var node = d3.select(document.createElement('div'))\n    node\n      .style('position', 'absolute')\n      .style('top', 0)\n      .style('opacity', 0)\n      .style('pointer-events', 'none')\n      .style('box-sizing', 'border-box')\n      .style('line-heigh', 1.1)\n      .style('padding', '6px')\n      .style('background', \"#000000c0\")\n      .style('color', '#fff')\n      .style('font-size', '14px')\n      .style('font-family', \"'Roboto Condensed', sans-serif\");\n\n    return node.node()\n  }\n\n  function getSVGNode(el) {\n    el = el.node()\n    if(el.tagName.toLowerCase() === 'svg')\n      return el\n\n    return el.ownerSVGElement\n  }\n\n  function getNodeEl() {\n    if(node === null) {\n      node = initNode();\n      // re-add node to DOM\n      document.body.appendChild(node);\n    };\n    return d3.select(node);\n  }\n\n  // Returns an Object {n, s, e, w, nw, sw, ne, se}\n  function getScreenBBox() {\n    var targetel   = target || d3.event.target;\n\n    while ('undefined' === typeof targetel.getScreenCTM && 'undefined' === targetel.parentNode) {\n        targetel = targetel.parentNode;\n    }\n\n    var bbox       = {},\n        matrix     = targetel.getScreenCTM(),\n        tbbox      = targetel.getBBox(),\n        width      = tbbox.width,\n        height     = tbbox.height,\n        x          = tbbox.x,\n        y          = tbbox.y\n\n    point.x = x\n    point.y = y\n    bbox.nw = point.matrixTransform(matrix)\n    point.x += width\n    bbox.ne = point.matrixTransform(matrix)\n    point.y += height\n    bbox.se = point.matrixTransform(matrix)\n    point.x -= width\n    bbox.sw = point.matrixTransform(matrix)\n    point.y -= height / 2\n    bbox.w  = point.matrixTransform(matrix)\n    point.x += width\n    bbox.e = point.matrixTransform(matrix)\n    point.x -= width / 2\n    point.y -= height / 2\n    bbox.n = point.matrixTransform(matrix)\n    point.y += height\n    bbox.s = point.matrixTransform(matrix)\n\n    return bbox\n  }\n\n  return tip\n};\nsvg = d3.select(svg.node());\n/* R2D3 Source File:  /Library/Frameworks/R.framework/Versions/3.5/Resources/library/iBreakDown/breakDownD3.js */\n// !preview r2d3 data=list(structure(list(\"+ Sex = female\", 0.306481792717087,    0.67272268907563, \"#0f6333\", \"Sex = 'female' <br>increases average response <br>by 0.3065\"), .Names = c(\"variable\", \"contribution\",\"cummulative\", \"sign\", \"label\")), structure(list(\"+ Fare = 71\",    0.0709915966386554, 0.743714285714286, \"#a3142f\", \"Fare = 71 (low value) <br>increases average response <br>by 0.071\"), .Names = c(\"variable\",\"contribution\", \"cummulative\", \"sign\", \"label\")), structure(list(    \"+ Pclass = 1\", 0.210210084033614, 0.953924369747899, \"#0f6333\",    \"Pclass = 1 (low value) <br>increases average response <br>by 0.2102\"), .Names = c(\"variable\", \"contribution\", \"cummulative\",\"sign\", \"label\")), structure(list(\"+ Embarked = C\", 0.0145014005602241,    0.968425770308123, \"#a3142f\", \"Embarked = 'C' <br>decreases average response <br>by 0.02\"), .Names = c(\"variable\", \"contribution\",\"cummulative\", \"sign\", \"label\")), structure(list(\"+ other factors\",    0.0154089635854342, 0.983834733893557, \"#a3142f\", \"All other features <br>decrease average response <br>by 0.01\"), .Names = c(\"variable\",\"contribution\", \"cummulative\", \"sign\", \"label\"))), dependencies = \"tooltipD3.js\", css = \"breakDownD3.css\", options=list(xmin = 0.3, xmax = 1, model_avg = 0.3662, model_res = 0.9869), d3_version = \"4\"\n//\n// r2d3: https://rstudio.github.io/r2d3\n//\n\nvar x_min   = options.xmin\nvar x_max   = options.xmax\nvar lmargin = 150\nvar rmargin = 10\nvar bmargin = 50\nvar tmargin = 50\nvar w     = width - lmargin - rmargin\nvar h     = height - bmargin - tmargin\n\nvar yAxis  = d3.scaleLinear().domain([0, data.length + 1.5]).range([tmargin, tmargin+h])\nvar xAxis  = d3.scaleLinear().domain([x_min, x_max]).range([lmargin,w + lmargin])\n\n// add OX axis to the plot\nsvg\n  .append(\"g\")\n  .selectAll('text')\n  .data(xAxis.ticks(7))\n  .enter().append('text')\n  .text(function(d) { return d; })\n  .attr('y', h + tmargin + 20)\n  .attr(\"x\", function(d) { return xAxis(d); })\n  .attr('text-anchor', 'middle')\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"fill\",\"#878787\")\n\n// add veritical lines to the plot\nsvg\n  .append(\"g\")\n  .selectAll('line')\n  .data(xAxis.ticks(7))\n  .enter().append('line')\n  .attr('y1', tmargin - 5)\n  .attr('y2', h + tmargin)\n  .attr(\"x1\", function(d) { return xAxis(d); })\n  .attr(\"x2\", function(d) { return xAxis(d); })\n  .style(\"stroke\",\"#b6b7b670\")\n  .style(\"stroke-width\",\"1\")\n  .style(\"stroke-dasharray\",\"4\")\n\n// baseline grouping object, here we will title and line\nvar baseg = svg\n  .append(\"g\")\n\n// plot line for model average\nbaseg\n  .append(\"line\")\n  .data([options.model_avg])\n  .attr('y1', 2)\n  .attr('y2', h + tmargin)\n  .attr(\"x1\", function(d) { return xAxis(d); })\n  .attr(\"x2\", function(d) { return xAxis(d); })\n  .style(\"stroke\",\"#b6b7b6\")\n  .style(\"stroke-width\",\"2\")\n\nbaseg\n  .append(\"text\")\n  .data([options.model_avg])\n  .attr(\"x\", function(d) { return xAxis(d) - 5; })\n  .attr(\"y\", 20)\n  .text(\"Average response\")\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"font-size\", \"20\")\n  .style(\"fill\",\"#878787\")\n  .attr(\"text-anchor\",\"end\")\n\nbaseg\n  .append(\"text\")\n  .data([options.model_avg])\n  .attr(\"x\", function(d) { return xAxis(d) - 5; })\n  .attr(\"y\", 40)\n  .text(function(d) { return d; })\n  .style(\"font-size\", \"18\")\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"fill\",\"#fa415a\")\n  .attr(\"text-anchor\",\"end\")\n\n// finalline grouping object, here we will title and line\nvar finalg = svg\n  .append(\"g\")\n\nfinalg\n  .append(\"text\")\n  .data([options.model_res])\n  .attr(\"x\", function(d) { return xAxis(d) - 5; })\n  .attr(\"y\", function(d) { return yAxis(data.length + 1) - 10; })\n  .text(\"Individual response\")\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"font-size\", \"20\")\n  .style(\"fill\",\"#878787\")\n  .attr(\"text-anchor\",\"end\")\n\nfinalg\n  .append(\"text\")\n  .data([options.model_res])\n  .attr(\"x\", function(d) { return xAxis(d) - 5; })\n  .attr(\"y\", function(d) { return yAxis(data.length+1)+10; })\n  .text(function(d) { return d; })\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"font-size\", \"18\")\n  .style(\"fill\",\"#fa415a\")\n  .attr(\"text-anchor\",\"end\")\n\n// main group, there we will plot all rectangles\nvar maing = svg\n  .append(\"g\")\n\n// tooltips set class for correct rendering (with CSS)\nvar tool_tip = d3.tip()\n      .attr(\"class\", \"d3-tip\")\n      .offset([-8, 0])\n      .html(function(d) { return d.label; });\n\nmaing\n  .call(tool_tip);\n\n// bars - main point of a plot\nmaing\n  .selectAll(\"rect\")\n  .data(data)\n  .enter()\n  .append(\"rect\")\n  .attr(\"x\", function(d) {  return xAxis(d.cummulative - Math.max(d.contribution, 0)); })\n  .attr(\"y\", function(d, i) { return yAxis(i) })\n  .attr(\"width\", function(d, i) { return Math.abs(xAxis(d.contribution) - xAxis(0)); })\n  .attr(\"height\", yAxis(1) - yAxis(0) - 2)\n  .style(\"fill\", function(d) { return d.sign; })\n    .on('mouseover', tool_tip.show)\n    .on('mouseout', tool_tip.hide);\n\n// add names of variables\nsvg\n  .append(\"g\")\n  .selectAll(\"text\")\n  .data(data)\n  .enter()\n  .append(\"text\")\n  .attr(\"x\", 0)\n  .attr(\"y\", function(d, i) { return yAxis(i + 0.7) })\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"fill\",\"#878787\")\n  .style(\"font-size\", \"20\")\n  .text(function(d) { return d.variable; })\n\n// add small links between rectangles\nsvg\n  .append(\"g\")\n  .selectAll(\"line\")\n  .data(data)\n  .enter()\n  .append(\"line\")\n  .attr(\"x1\", function(d) { return xAxis(d.cummulative); })\n  .attr(\"x2\", function(d) { return xAxis(d.cummulative); })\n  .attr(\"y1\", function(d, i) { return yAxis(i) })\n  .attr(\"y2\", function(d, i) { return yAxis(i + 2)-2 })\n  .style(\"stroke\",\"black\")\n  .style(\"stroke-width\",\"1\")\n};","style":"/* R2D3 Source File:  /Library/Frameworks/R.framework/Versions/3.5/Resources/library/iBreakDown/breakDownD3.css */\n.d3-tip {\n    line-height: 1.1;\n    padding: 6px;\n    background: #00000080;\n    color: #fff;\n    border-radius: 0px;\n    font-size: 14px;\n    font-family: 'Roboto Condensed', sans-serif;\n  }\n\n  /* Creates a small triangle extender for the tooltip */\n  .d3-tip:after {\n    box-sizing: border-box;\n    display: inline;\n    font-size: 10px;\n    width: 100%;\n    line-height: 1;\n    color: rgba(0, 0, 0, 0.8);\n    content: \"\\25BC\";\n    position: absolute;\n    text-align: center;\n  }\n\n  /* Style northward tooltips specifically */\n  .d3-tip.n:after {\n    margin: -2px 0 0 0;\n    top: 100%;\n    left: 0;\n  }","version":4,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
</div>
<div id="calculate-uncertainty-for-variable-attributions" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-uncertainty-for-variable-attributions" class="anchor"></a>Calculate uncertainty for variable attributions</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">rf_la_un &lt;-<span class="st"> </span><span class="kw">local_attributions_uncertainty</span>(explain_titanic_rf, new_passanger,</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">                         <span class="dt">path =</span> <span class="kw">c</span>(<span class="st">"age"</span>, <span class="st">"class"</span>, <span class="st">"gender"</span> , <span class="st">"fare"</span>, <span class="st">"embarked"</span>, <span class="st">"sibsp"</span>, <span class="st">"parch"</span>))</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw">plot</span>(rf_la_un)</a></code></pre></div>
<p><img src="vignette_iBreakDown_titanic_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</div>
<div id="show-only-top-features" class="section level2">
<h2 class="hasAnchor">
<a href="#show-only-top-features" class="anchor"></a>Show only top features</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../reference/plotD3.html">plotD3</a></span>(rf_la, <span class="dt">max_features =</span> <span class="dv">3</span>)</a></code></pre></div>
<div id="htmlwidget-138b5548cb37a8001125" style="width:672px;height:336px;" class="r2d3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-138b5548cb37a8001125">{"x":{"data":[{"variable":"age = 8","contribution":0.193943226485464,"cummulative":0.518189722895281,"sign":"#8bdcbe","label":"age = 8<br>increases average response <br>by 0.194"},{"variable":"class = 1st","contribution":0.0664084814300531,"cummulative":0.584598204325334,"sign":"#8bdcbe","label":"class = 1st<br>increases average response <br>by 0.066"},{"variable":"gender = male","contribution":-0.0577068226595366,"cummulative":0.526891381665797,"sign":"#f05a71","label":"gender = male<br>decreases average response <br>by 0.058"},{"variable":"  + all other factors","contribution":-0.115306742619637,"cummulative":0.41158463904616,"sign":"#f05a71","label":"  + all other factors<br>decreases average response <br>by 0.115"}],"type":"list","container":"svg","options":{"xmin":0.3078,"xmax":0.613828114541601,"model_avg":0.324,"model_res":0.412},"script":"var d3Script = function(d3, r2d3, data, svg, width, height, options, theme, console) {\nthis.d3 = d3;\n/* R2D3 Source File:  /Library/Frameworks/R.framework/Versions/3.5/Resources/library/iBreakDown/tooltipD3.js */\n// TOOLTIP\n\n// d3.tip\n// Copyright (c) 2013 Justin Palmer\n// ES6 / D3 v4 Adaption Copyright (c) 2016 Constantin Gavrilete\n// Removal of ES6 for D3 v4 Adaption Copyright (c) 2016 David Gotz\n//\n// Tooltips for d3.js SVG visualizations\nd3.functor = function functor(v) {\n  return typeof v === \"function\" ? v : function() {\n    return v;\n  };\n};\n\nd3.tip = function() {\n\n  var direction = d3_tip_direction,\n      offset    = d3_tip_offset,\n      html      = d3_tip_html,\n      node      = initNode(),\n      svg       = null,\n      point     = null,\n      target    = null\n\n  function tip(vis) {\n    svg = getSVGNode(vis)\n    point = svg.createSVGPoint()\n    document.body.appendChild(node)\n  }\n\n  // Public - show the tooltip on the screen\n  //\n  // Returns a tip\n  tip.show = function() {\n    var args = Array.prototype.slice.call(arguments)\n    if(args[args.length - 1] instanceof SVGElement) target = args.pop()\n\n    var content = html.apply(this, args),\n        poffset = offset.apply(this, args),\n        dir     = direction.apply(this, args),\n        nodel   = getNodeEl(),\n        i       = directions.length,\n        coords,\n        scrollTop  = document.documentElement.scrollTop || document.body.scrollTop,\n        scrollLeft = document.documentElement.scrollLeft || document.body.scrollLeft\n\n    nodel.html(content)\n      .style('position', 'absolute')\n      .style('opacity', 1)\n      .style('pointer-events', 'all')\n\n    while(i--) nodel.classed(directions[i], false)\n    coords = direction_callbacks[dir].apply(this)\n    nodel.classed(dir, true)\n      .style('top', (coords.top +  poffset[0]) + scrollTop + 'px')\n      .style('left', (coords.left + poffset[1]) + scrollLeft + 'px')\n\n    return tip\n  }\n\n  // Public - hide the tooltip\n  //\n  // Returns a tip\n  tip.hide = function() {\n    var nodel = getNodeEl()\n    nodel\n      .style('opacity', 0)\n      .style('pointer-events', 'none')\n    return tip\n  }\n\n  // Public: Proxy attr calls to the d3 tip container.  Sets or gets attribute value.\n  //\n  // n - name of the attribute\n  // v - value of the attribute\n  //\n  // Returns tip or attribute value\n  tip.attr = function(n, v) {\n    if (arguments.length < 2 && typeof n === 'string') {\n      return getNodeEl().attr(n)\n    } else {\n      var args =  Array.prototype.slice.call(arguments)\n      d3.selection.prototype.attr.apply(getNodeEl(), args)\n    }\n\n    return tip\n  }\n\n  // Public: Proxy style calls to the d3 tip container.  Sets or gets a style value.\n  //\n  // n - name of the property\n  // v - value of the property\n  //\n  // Returns tip or style property value\n  tip.style = function(n, v) {\n    // debugger;\n    if (arguments.length < 2 && typeof n === 'string') {\n      return getNodeEl().style(n)\n    } else {\n      var args = Array.prototype.slice.call(arguments);\n      if (args.length === 1) {\n        var styles = args[0];\n        Object.keys(styles).forEach(function(key) {\n          return d3.selection.prototype.style.apply(getNodeEl(), [key, styles[key]]);\n        });\n      }\n    }\n\n    return tip\n  }\n\n  // Public: Set or get the direction of the tooltip\n  //\n  // v - One of n(north), s(south), e(east), or w(west), nw(northwest),\n  //     sw(southwest), ne(northeast) or se(southeast)\n  //\n  // Returns tip or direction\n  tip.direction = function(v) {\n    if (!arguments.length) return direction\n    direction = v == null ? v : d3.functor(v)\n\n    return tip\n  }\n\n  // Public: Sets or gets the offset of the tip\n  //\n  // v - Array of [x, y] offset\n  //\n  // Returns offset or\n  tip.offset = function(v) {\n    if (!arguments.length) return offset\n    offset = v == null ? v : d3.functor(v)\n\n    return tip\n  }\n\n  // Public: sets or gets the html value of the tooltip\n  //\n  // v - String value of the tip\n  //\n  // Returns html value or tip\n  tip.html = function(v) {\n    if (!arguments.length) return html\n    html = v == null ? v : d3.functor(v)\n\n    return tip\n  }\n\n  // Public: destroys the tooltip and removes it from the DOM\n  //\n  // Returns a tip\n  tip.destroy = function() {\n    if(node) {\n      getNodeEl().remove();\n      node = null;\n    }\n    return tip;\n  }\n\n  function d3_tip_direction() { return 'n' }\n  function d3_tip_offset() { return [0, 0] }\n  function d3_tip_html() { return ' ' }\n\n  var direction_callbacks = {\n    n:  direction_n,\n    s:  direction_s,\n    e:  direction_e,\n    w:  direction_w,\n    nw: direction_nw,\n    ne: direction_ne,\n    sw: direction_sw,\n    se: direction_se\n  };\n\n  var directions = Object.keys(direction_callbacks);\n\n  function direction_n() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.n.y - node.offsetHeight,\n      left: bbox.n.x - node.offsetWidth / 2\n    }\n  }\n\n  function direction_s() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.s.y,\n      left: bbox.s.x - node.offsetWidth / 2\n    }\n  }\n\n  function direction_e() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.e.y - node.offsetHeight / 2,\n      left: bbox.e.x\n    }\n  }\n\n  function direction_w() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.w.y - node.offsetHeight / 2,\n      left: bbox.w.x - node.offsetWidth\n    }\n  }\n\n  function direction_nw() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.nw.y - node.offsetHeight,\n      left: bbox.nw.x - node.offsetWidth\n    }\n  }\n\n  function direction_ne() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.ne.y - node.offsetHeight,\n      left: bbox.ne.x\n    }\n  }\n\n  function direction_sw() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.sw.y,\n      left: bbox.sw.x - node.offsetWidth\n    }\n  }\n\n  function direction_se() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.se.y,\n      left: bbox.e.x\n    }\n  }\n\n  function initNode() {\n    var node = d3.select(document.createElement('div'))\n    node\n      .style('position', 'absolute')\n      .style('top', 0)\n      .style('opacity', 0)\n      .style('pointer-events', 'none')\n      .style('box-sizing', 'border-box')\n      .style('line-heigh', 1.1)\n      .style('padding', '6px')\n      .style('background', \"#000000c0\")\n      .style('color', '#fff')\n      .style('font-size', '14px')\n      .style('font-family', \"'Roboto Condensed', sans-serif\");\n\n    return node.node()\n  }\n\n  function getSVGNode(el) {\n    el = el.node()\n    if(el.tagName.toLowerCase() === 'svg')\n      return el\n\n    return el.ownerSVGElement\n  }\n\n  function getNodeEl() {\n    if(node === null) {\n      node = initNode();\n      // re-add node to DOM\n      document.body.appendChild(node);\n    };\n    return d3.select(node);\n  }\n\n  // Returns an Object {n, s, e, w, nw, sw, ne, se}\n  function getScreenBBox() {\n    var targetel   = target || d3.event.target;\n\n    while ('undefined' === typeof targetel.getScreenCTM && 'undefined' === targetel.parentNode) {\n        targetel = targetel.parentNode;\n    }\n\n    var bbox       = {},\n        matrix     = targetel.getScreenCTM(),\n        tbbox      = targetel.getBBox(),\n        width      = tbbox.width,\n        height     = tbbox.height,\n        x          = tbbox.x,\n        y          = tbbox.y\n\n    point.x = x\n    point.y = y\n    bbox.nw = point.matrixTransform(matrix)\n    point.x += width\n    bbox.ne = point.matrixTransform(matrix)\n    point.y += height\n    bbox.se = point.matrixTransform(matrix)\n    point.x -= width\n    bbox.sw = point.matrixTransform(matrix)\n    point.y -= height / 2\n    bbox.w  = point.matrixTransform(matrix)\n    point.x += width\n    bbox.e = point.matrixTransform(matrix)\n    point.x -= width / 2\n    point.y -= height / 2\n    bbox.n = point.matrixTransform(matrix)\n    point.y += height\n    bbox.s = point.matrixTransform(matrix)\n\n    return bbox\n  }\n\n  return tip\n};\nsvg = d3.select(svg.node());\n/* R2D3 Source File:  /Library/Frameworks/R.framework/Versions/3.5/Resources/library/iBreakDown/breakDownD3.js */\n// !preview r2d3 data=list(structure(list(\"+ Sex = female\", 0.306481792717087,    0.67272268907563, \"#0f6333\", \"Sex = 'female' <br>increases average response <br>by 0.3065\"), .Names = c(\"variable\", \"contribution\",\"cummulative\", \"sign\", \"label\")), structure(list(\"+ Fare = 71\",    0.0709915966386554, 0.743714285714286, \"#a3142f\", \"Fare = 71 (low value) <br>increases average response <br>by 0.071\"), .Names = c(\"variable\",\"contribution\", \"cummulative\", \"sign\", \"label\")), structure(list(    \"+ Pclass = 1\", 0.210210084033614, 0.953924369747899, \"#0f6333\",    \"Pclass = 1 (low value) <br>increases average response <br>by 0.2102\"), .Names = c(\"variable\", \"contribution\", \"cummulative\",\"sign\", \"label\")), structure(list(\"+ Embarked = C\", 0.0145014005602241,    0.968425770308123, \"#a3142f\", \"Embarked = 'C' <br>decreases average response <br>by 0.02\"), .Names = c(\"variable\", \"contribution\",\"cummulative\", \"sign\", \"label\")), structure(list(\"+ other factors\",    0.0154089635854342, 0.983834733893557, \"#a3142f\", \"All other features <br>decrease average response <br>by 0.01\"), .Names = c(\"variable\",\"contribution\", \"cummulative\", \"sign\", \"label\"))), dependencies = \"tooltipD3.js\", css = \"breakDownD3.css\", options=list(xmin = 0.3, xmax = 1, model_avg = 0.3662, model_res = 0.9869), d3_version = \"4\"\n//\n// r2d3: https://rstudio.github.io/r2d3\n//\n\nvar x_min   = options.xmin\nvar x_max   = options.xmax\nvar lmargin = 150\nvar rmargin = 10\nvar bmargin = 50\nvar tmargin = 50\nvar w     = width - lmargin - rmargin\nvar h     = height - bmargin - tmargin\n\nvar yAxis  = d3.scaleLinear().domain([0, data.length + 1.5]).range([tmargin, tmargin+h])\nvar xAxis  = d3.scaleLinear().domain([x_min, x_max]).range([lmargin,w + lmargin])\n\n// add OX axis to the plot\nsvg\n  .append(\"g\")\n  .selectAll('text')\n  .data(xAxis.ticks(7))\n  .enter().append('text')\n  .text(function(d) { return d; })\n  .attr('y', h + tmargin + 20)\n  .attr(\"x\", function(d) { return xAxis(d); })\n  .attr('text-anchor', 'middle')\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"fill\",\"#878787\")\n\n// add veritical lines to the plot\nsvg\n  .append(\"g\")\n  .selectAll('line')\n  .data(xAxis.ticks(7))\n  .enter().append('line')\n  .attr('y1', tmargin - 5)\n  .attr('y2', h + tmargin)\n  .attr(\"x1\", function(d) { return xAxis(d); })\n  .attr(\"x2\", function(d) { return xAxis(d); })\n  .style(\"stroke\",\"#b6b7b670\")\n  .style(\"stroke-width\",\"1\")\n  .style(\"stroke-dasharray\",\"4\")\n\n// baseline grouping object, here we will title and line\nvar baseg = svg\n  .append(\"g\")\n\n// plot line for model average\nbaseg\n  .append(\"line\")\n  .data([options.model_avg])\n  .attr('y1', 2)\n  .attr('y2', h + tmargin)\n  .attr(\"x1\", function(d) { return xAxis(d); })\n  .attr(\"x2\", function(d) { return xAxis(d); })\n  .style(\"stroke\",\"#b6b7b6\")\n  .style(\"stroke-width\",\"2\")\n\nbaseg\n  .append(\"text\")\n  .data([options.model_avg])\n  .attr(\"x\", function(d) { return xAxis(d) - 5; })\n  .attr(\"y\", 20)\n  .text(\"Average response\")\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"font-size\", \"20\")\n  .style(\"fill\",\"#878787\")\n  .attr(\"text-anchor\",\"end\")\n\nbaseg\n  .append(\"text\")\n  .data([options.model_avg])\n  .attr(\"x\", function(d) { return xAxis(d) - 5; })\n  .attr(\"y\", 40)\n  .text(function(d) { return d; })\n  .style(\"font-size\", \"18\")\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"fill\",\"#fa415a\")\n  .attr(\"text-anchor\",\"end\")\n\n// finalline grouping object, here we will title and line\nvar finalg = svg\n  .append(\"g\")\n\nfinalg\n  .append(\"text\")\n  .data([options.model_res])\n  .attr(\"x\", function(d) { return xAxis(d) - 5; })\n  .attr(\"y\", function(d) { return yAxis(data.length + 1) - 10; })\n  .text(\"Individual response\")\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"font-size\", \"20\")\n  .style(\"fill\",\"#878787\")\n  .attr(\"text-anchor\",\"end\")\n\nfinalg\n  .append(\"text\")\n  .data([options.model_res])\n  .attr(\"x\", function(d) { return xAxis(d) - 5; })\n  .attr(\"y\", function(d) { return yAxis(data.length+1)+10; })\n  .text(function(d) { return d; })\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"font-size\", \"18\")\n  .style(\"fill\",\"#fa415a\")\n  .attr(\"text-anchor\",\"end\")\n\n// main group, there we will plot all rectangles\nvar maing = svg\n  .append(\"g\")\n\n// tooltips set class for correct rendering (with CSS)\nvar tool_tip = d3.tip()\n      .attr(\"class\", \"d3-tip\")\n      .offset([-8, 0])\n      .html(function(d) { return d.label; });\n\nmaing\n  .call(tool_tip);\n\n// bars - main point of a plot\nmaing\n  .selectAll(\"rect\")\n  .data(data)\n  .enter()\n  .append(\"rect\")\n  .attr(\"x\", function(d) {  return xAxis(d.cummulative - Math.max(d.contribution, 0)); })\n  .attr(\"y\", function(d, i) { return yAxis(i) })\n  .attr(\"width\", function(d, i) { return Math.abs(xAxis(d.contribution) - xAxis(0)); })\n  .attr(\"height\", yAxis(1) - yAxis(0) - 2)\n  .style(\"fill\", function(d) { return d.sign; })\n    .on('mouseover', tool_tip.show)\n    .on('mouseout', tool_tip.hide);\n\n// add names of variables\nsvg\n  .append(\"g\")\n  .selectAll(\"text\")\n  .data(data)\n  .enter()\n  .append(\"text\")\n  .attr(\"x\", 0)\n  .attr(\"y\", function(d, i) { return yAxis(i + 0.7) })\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"fill\",\"#878787\")\n  .style(\"font-size\", \"20\")\n  .text(function(d) { return d.variable; })\n\n// add small links between rectangles\nsvg\n  .append(\"g\")\n  .selectAll(\"line\")\n  .data(data)\n  .enter()\n  .append(\"line\")\n  .attr(\"x1\", function(d) { return xAxis(d.cummulative); })\n  .attr(\"x2\", function(d) { return xAxis(d.cummulative); })\n  .attr(\"y1\", function(d, i) { return yAxis(i) })\n  .attr(\"y2\", function(d, i) { return yAxis(i + 2)-2 })\n  .style(\"stroke\",\"black\")\n  .style(\"stroke-width\",\"1\")\n};","style":"/* R2D3 Source File:  /Library/Frameworks/R.framework/Versions/3.5/Resources/library/iBreakDown/breakDownD3.css */\n.d3-tip {\n    line-height: 1.1;\n    padding: 6px;\n    background: #00000080;\n    color: #fff;\n    border-radius: 0px;\n    font-size: 14px;\n    font-family: 'Roboto Condensed', sans-serif;\n  }\n\n  /* Creates a small triangle extender for the tooltip */\n  .d3-tip:after {\n    box-sizing: border-box;\n    display: inline;\n    font-size: 10px;\n    width: 100%;\n    line-height: 1;\n    color: rgba(0, 0, 0, 0.8);\n    content: \"\\25BC\";\n    position: absolute;\n    text-align: center;\n  }\n\n  /* Style northward tooltips specifically */\n  .d3-tip.n:after {\n    margin: -2px 0 0 0;\n    top: 100%;\n    left: 0;\n  }","version":4,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
</div>
<div id="force-ox-axis-to-be-from-0-to-1" class="section level2">
<h2 class="hasAnchor">
<a href="#force-ox-axis-to-be-from-0-to-1" class="anchor"></a>Force OX axis to be from 0 to 1</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../reference/plotD3.html">plotD3</a></span>(rf_la, <span class="dt">max_features =</span> <span class="dv">3</span>, <span class="dt">min_max =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a></code></pre></div>
<div id="htmlwidget-5474c69189c821358701" style="width:672px;height:336px;" class="r2d3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-5474c69189c821358701">{"x":{"data":[{"variable":"age = 8","contribution":0.193943226485464,"cummulative":0.518189722895281,"sign":"#8bdcbe","label":"age = 8<br>increases average response <br>by 0.194"},{"variable":"class = 1st","contribution":0.0664084814300531,"cummulative":0.584598204325334,"sign":"#8bdcbe","label":"class = 1st<br>increases average response <br>by 0.066"},{"variable":"gender = male","contribution":-0.0577068226595366,"cummulative":0.526891381665797,"sign":"#f05a71","label":"gender = male<br>decreases average response <br>by 0.058"},{"variable":"  + all other factors","contribution":-0.115306742619637,"cummulative":0.41158463904616,"sign":"#f05a71","label":"  + all other factors<br>decreases average response <br>by 0.115"}],"type":"list","container":"svg","options":{"xmin":0,"xmax":1,"model_avg":0.324,"model_res":0.412},"script":"var d3Script = function(d3, r2d3, data, svg, width, height, options, theme, console) {\nthis.d3 = d3;\n/* R2D3 Source File:  /Library/Frameworks/R.framework/Versions/3.5/Resources/library/iBreakDown/tooltipD3.js */\n// TOOLTIP\n\n// d3.tip\n// Copyright (c) 2013 Justin Palmer\n// ES6 / D3 v4 Adaption Copyright (c) 2016 Constantin Gavrilete\n// Removal of ES6 for D3 v4 Adaption Copyright (c) 2016 David Gotz\n//\n// Tooltips for d3.js SVG visualizations\nd3.functor = function functor(v) {\n  return typeof v === \"function\" ? v : function() {\n    return v;\n  };\n};\n\nd3.tip = function() {\n\n  var direction = d3_tip_direction,\n      offset    = d3_tip_offset,\n      html      = d3_tip_html,\n      node      = initNode(),\n      svg       = null,\n      point     = null,\n      target    = null\n\n  function tip(vis) {\n    svg = getSVGNode(vis)\n    point = svg.createSVGPoint()\n    document.body.appendChild(node)\n  }\n\n  // Public - show the tooltip on the screen\n  //\n  // Returns a tip\n  tip.show = function() {\n    var args = Array.prototype.slice.call(arguments)\n    if(args[args.length - 1] instanceof SVGElement) target = args.pop()\n\n    var content = html.apply(this, args),\n        poffset = offset.apply(this, args),\n        dir     = direction.apply(this, args),\n        nodel   = getNodeEl(),\n        i       = directions.length,\n        coords,\n        scrollTop  = document.documentElement.scrollTop || document.body.scrollTop,\n        scrollLeft = document.documentElement.scrollLeft || document.body.scrollLeft\n\n    nodel.html(content)\n      .style('position', 'absolute')\n      .style('opacity', 1)\n      .style('pointer-events', 'all')\n\n    while(i--) nodel.classed(directions[i], false)\n    coords = direction_callbacks[dir].apply(this)\n    nodel.classed(dir, true)\n      .style('top', (coords.top +  poffset[0]) + scrollTop + 'px')\n      .style('left', (coords.left + poffset[1]) + scrollLeft + 'px')\n\n    return tip\n  }\n\n  // Public - hide the tooltip\n  //\n  // Returns a tip\n  tip.hide = function() {\n    var nodel = getNodeEl()\n    nodel\n      .style('opacity', 0)\n      .style('pointer-events', 'none')\n    return tip\n  }\n\n  // Public: Proxy attr calls to the d3 tip container.  Sets or gets attribute value.\n  //\n  // n - name of the attribute\n  // v - value of the attribute\n  //\n  // Returns tip or attribute value\n  tip.attr = function(n, v) {\n    if (arguments.length < 2 && typeof n === 'string') {\n      return getNodeEl().attr(n)\n    } else {\n      var args =  Array.prototype.slice.call(arguments)\n      d3.selection.prototype.attr.apply(getNodeEl(), args)\n    }\n\n    return tip\n  }\n\n  // Public: Proxy style calls to the d3 tip container.  Sets or gets a style value.\n  //\n  // n - name of the property\n  // v - value of the property\n  //\n  // Returns tip or style property value\n  tip.style = function(n, v) {\n    // debugger;\n    if (arguments.length < 2 && typeof n === 'string') {\n      return getNodeEl().style(n)\n    } else {\n      var args = Array.prototype.slice.call(arguments);\n      if (args.length === 1) {\n        var styles = args[0];\n        Object.keys(styles).forEach(function(key) {\n          return d3.selection.prototype.style.apply(getNodeEl(), [key, styles[key]]);\n        });\n      }\n    }\n\n    return tip\n  }\n\n  // Public: Set or get the direction of the tooltip\n  //\n  // v - One of n(north), s(south), e(east), or w(west), nw(northwest),\n  //     sw(southwest), ne(northeast) or se(southeast)\n  //\n  // Returns tip or direction\n  tip.direction = function(v) {\n    if (!arguments.length) return direction\n    direction = v == null ? v : d3.functor(v)\n\n    return tip\n  }\n\n  // Public: Sets or gets the offset of the tip\n  //\n  // v - Array of [x, y] offset\n  //\n  // Returns offset or\n  tip.offset = function(v) {\n    if (!arguments.length) return offset\n    offset = v == null ? v : d3.functor(v)\n\n    return tip\n  }\n\n  // Public: sets or gets the html value of the tooltip\n  //\n  // v - String value of the tip\n  //\n  // Returns html value or tip\n  tip.html = function(v) {\n    if (!arguments.length) return html\n    html = v == null ? v : d3.functor(v)\n\n    return tip\n  }\n\n  // Public: destroys the tooltip and removes it from the DOM\n  //\n  // Returns a tip\n  tip.destroy = function() {\n    if(node) {\n      getNodeEl().remove();\n      node = null;\n    }\n    return tip;\n  }\n\n  function d3_tip_direction() { return 'n' }\n  function d3_tip_offset() { return [0, 0] }\n  function d3_tip_html() { return ' ' }\n\n  var direction_callbacks = {\n    n:  direction_n,\n    s:  direction_s,\n    e:  direction_e,\n    w:  direction_w,\n    nw: direction_nw,\n    ne: direction_ne,\n    sw: direction_sw,\n    se: direction_se\n  };\n\n  var directions = Object.keys(direction_callbacks);\n\n  function direction_n() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.n.y - node.offsetHeight,\n      left: bbox.n.x - node.offsetWidth / 2\n    }\n  }\n\n  function direction_s() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.s.y,\n      left: bbox.s.x - node.offsetWidth / 2\n    }\n  }\n\n  function direction_e() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.e.y - node.offsetHeight / 2,\n      left: bbox.e.x\n    }\n  }\n\n  function direction_w() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.w.y - node.offsetHeight / 2,\n      left: bbox.w.x - node.offsetWidth\n    }\n  }\n\n  function direction_nw() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.nw.y - node.offsetHeight,\n      left: bbox.nw.x - node.offsetWidth\n    }\n  }\n\n  function direction_ne() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.ne.y - node.offsetHeight,\n      left: bbox.ne.x\n    }\n  }\n\n  function direction_sw() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.sw.y,\n      left: bbox.sw.x - node.offsetWidth\n    }\n  }\n\n  function direction_se() {\n    var bbox = getScreenBBox()\n    return {\n      top:  bbox.se.y,\n      left: bbox.e.x\n    }\n  }\n\n  function initNode() {\n    var node = d3.select(document.createElement('div'))\n    node\n      .style('position', 'absolute')\n      .style('top', 0)\n      .style('opacity', 0)\n      .style('pointer-events', 'none')\n      .style('box-sizing', 'border-box')\n      .style('line-heigh', 1.1)\n      .style('padding', '6px')\n      .style('background', \"#000000c0\")\n      .style('color', '#fff')\n      .style('font-size', '14px')\n      .style('font-family', \"'Roboto Condensed', sans-serif\");\n\n    return node.node()\n  }\n\n  function getSVGNode(el) {\n    el = el.node()\n    if(el.tagName.toLowerCase() === 'svg')\n      return el\n\n    return el.ownerSVGElement\n  }\n\n  function getNodeEl() {\n    if(node === null) {\n      node = initNode();\n      // re-add node to DOM\n      document.body.appendChild(node);\n    };\n    return d3.select(node);\n  }\n\n  // Returns an Object {n, s, e, w, nw, sw, ne, se}\n  function getScreenBBox() {\n    var targetel   = target || d3.event.target;\n\n    while ('undefined' === typeof targetel.getScreenCTM && 'undefined' === targetel.parentNode) {\n        targetel = targetel.parentNode;\n    }\n\n    var bbox       = {},\n        matrix     = targetel.getScreenCTM(),\n        tbbox      = targetel.getBBox(),\n        width      = tbbox.width,\n        height     = tbbox.height,\n        x          = tbbox.x,\n        y          = tbbox.y\n\n    point.x = x\n    point.y = y\n    bbox.nw = point.matrixTransform(matrix)\n    point.x += width\n    bbox.ne = point.matrixTransform(matrix)\n    point.y += height\n    bbox.se = point.matrixTransform(matrix)\n    point.x -= width\n    bbox.sw = point.matrixTransform(matrix)\n    point.y -= height / 2\n    bbox.w  = point.matrixTransform(matrix)\n    point.x += width\n    bbox.e = point.matrixTransform(matrix)\n    point.x -= width / 2\n    point.y -= height / 2\n    bbox.n = point.matrixTransform(matrix)\n    point.y += height\n    bbox.s = point.matrixTransform(matrix)\n\n    return bbox\n  }\n\n  return tip\n};\nsvg = d3.select(svg.node());\n/* R2D3 Source File:  /Library/Frameworks/R.framework/Versions/3.5/Resources/library/iBreakDown/breakDownD3.js */\n// !preview r2d3 data=list(structure(list(\"+ Sex = female\", 0.306481792717087,    0.67272268907563, \"#0f6333\", \"Sex = 'female' <br>increases average response <br>by 0.3065\"), .Names = c(\"variable\", \"contribution\",\"cummulative\", \"sign\", \"label\")), structure(list(\"+ Fare = 71\",    0.0709915966386554, 0.743714285714286, \"#a3142f\", \"Fare = 71 (low value) <br>increases average response <br>by 0.071\"), .Names = c(\"variable\",\"contribution\", \"cummulative\", \"sign\", \"label\")), structure(list(    \"+ Pclass = 1\", 0.210210084033614, 0.953924369747899, \"#0f6333\",    \"Pclass = 1 (low value) <br>increases average response <br>by 0.2102\"), .Names = c(\"variable\", \"contribution\", \"cummulative\",\"sign\", \"label\")), structure(list(\"+ Embarked = C\", 0.0145014005602241,    0.968425770308123, \"#a3142f\", \"Embarked = 'C' <br>decreases average response <br>by 0.02\"), .Names = c(\"variable\", \"contribution\",\"cummulative\", \"sign\", \"label\")), structure(list(\"+ other factors\",    0.0154089635854342, 0.983834733893557, \"#a3142f\", \"All other features <br>decrease average response <br>by 0.01\"), .Names = c(\"variable\",\"contribution\", \"cummulative\", \"sign\", \"label\"))), dependencies = \"tooltipD3.js\", css = \"breakDownD3.css\", options=list(xmin = 0.3, xmax = 1, model_avg = 0.3662, model_res = 0.9869), d3_version = \"4\"\n//\n// r2d3: https://rstudio.github.io/r2d3\n//\n\nvar x_min   = options.xmin\nvar x_max   = options.xmax\nvar lmargin = 150\nvar rmargin = 10\nvar bmargin = 50\nvar tmargin = 50\nvar w     = width - lmargin - rmargin\nvar h     = height - bmargin - tmargin\n\nvar yAxis  = d3.scaleLinear().domain([0, data.length + 1.5]).range([tmargin, tmargin+h])\nvar xAxis  = d3.scaleLinear().domain([x_min, x_max]).range([lmargin,w + lmargin])\n\n// add OX axis to the plot\nsvg\n  .append(\"g\")\n  .selectAll('text')\n  .data(xAxis.ticks(7))\n  .enter().append('text')\n  .text(function(d) { return d; })\n  .attr('y', h + tmargin + 20)\n  .attr(\"x\", function(d) { return xAxis(d); })\n  .attr('text-anchor', 'middle')\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"fill\",\"#878787\")\n\n// add veritical lines to the plot\nsvg\n  .append(\"g\")\n  .selectAll('line')\n  .data(xAxis.ticks(7))\n  .enter().append('line')\n  .attr('y1', tmargin - 5)\n  .attr('y2', h + tmargin)\n  .attr(\"x1\", function(d) { return xAxis(d); })\n  .attr(\"x2\", function(d) { return xAxis(d); })\n  .style(\"stroke\",\"#b6b7b670\")\n  .style(\"stroke-width\",\"1\")\n  .style(\"stroke-dasharray\",\"4\")\n\n// baseline grouping object, here we will title and line\nvar baseg = svg\n  .append(\"g\")\n\n// plot line for model average\nbaseg\n  .append(\"line\")\n  .data([options.model_avg])\n  .attr('y1', 2)\n  .attr('y2', h + tmargin)\n  .attr(\"x1\", function(d) { return xAxis(d); })\n  .attr(\"x2\", function(d) { return xAxis(d); })\n  .style(\"stroke\",\"#b6b7b6\")\n  .style(\"stroke-width\",\"2\")\n\nbaseg\n  .append(\"text\")\n  .data([options.model_avg])\n  .attr(\"x\", function(d) { return xAxis(d) - 5; })\n  .attr(\"y\", 20)\n  .text(\"Average response\")\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"font-size\", \"20\")\n  .style(\"fill\",\"#878787\")\n  .attr(\"text-anchor\",\"end\")\n\nbaseg\n  .append(\"text\")\n  .data([options.model_avg])\n  .attr(\"x\", function(d) { return xAxis(d) - 5; })\n  .attr(\"y\", 40)\n  .text(function(d) { return d; })\n  .style(\"font-size\", \"18\")\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"fill\",\"#fa415a\")\n  .attr(\"text-anchor\",\"end\")\n\n// finalline grouping object, here we will title and line\nvar finalg = svg\n  .append(\"g\")\n\nfinalg\n  .append(\"text\")\n  .data([options.model_res])\n  .attr(\"x\", function(d) { return xAxis(d) - 5; })\n  .attr(\"y\", function(d) { return yAxis(data.length + 1) - 10; })\n  .text(\"Individual response\")\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"font-size\", \"20\")\n  .style(\"fill\",\"#878787\")\n  .attr(\"text-anchor\",\"end\")\n\nfinalg\n  .append(\"text\")\n  .data([options.model_res])\n  .attr(\"x\", function(d) { return xAxis(d) - 5; })\n  .attr(\"y\", function(d) { return yAxis(data.length+1)+10; })\n  .text(function(d) { return d; })\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"font-size\", \"18\")\n  .style(\"fill\",\"#fa415a\")\n  .attr(\"text-anchor\",\"end\")\n\n// main group, there we will plot all rectangles\nvar maing = svg\n  .append(\"g\")\n\n// tooltips set class for correct rendering (with CSS)\nvar tool_tip = d3.tip()\n      .attr(\"class\", \"d3-tip\")\n      .offset([-8, 0])\n      .html(function(d) { return d.label; });\n\nmaing\n  .call(tool_tip);\n\n// bars - main point of a plot\nmaing\n  .selectAll(\"rect\")\n  .data(data)\n  .enter()\n  .append(\"rect\")\n  .attr(\"x\", function(d) {  return xAxis(d.cummulative - Math.max(d.contribution, 0)); })\n  .attr(\"y\", function(d, i) { return yAxis(i) })\n  .attr(\"width\", function(d, i) { return Math.abs(xAxis(d.contribution) - xAxis(0)); })\n  .attr(\"height\", yAxis(1) - yAxis(0) - 2)\n  .style(\"fill\", function(d) { return d.sign; })\n    .on('mouseover', tool_tip.show)\n    .on('mouseout', tool_tip.hide);\n\n// add names of variables\nsvg\n  .append(\"g\")\n  .selectAll(\"text\")\n  .data(data)\n  .enter()\n  .append(\"text\")\n  .attr(\"x\", 0)\n  .attr(\"y\", function(d, i) { return yAxis(i + 0.7) })\n  .style(\"font-family\", \"'Roboto Condensed', sans-serif\")\n  .style(\"fill\",\"#878787\")\n  .style(\"font-size\", \"20\")\n  .text(function(d) { return d.variable; })\n\n// add small links between rectangles\nsvg\n  .append(\"g\")\n  .selectAll(\"line\")\n  .data(data)\n  .enter()\n  .append(\"line\")\n  .attr(\"x1\", function(d) { return xAxis(d.cummulative); })\n  .attr(\"x2\", function(d) { return xAxis(d.cummulative); })\n  .attr(\"y1\", function(d, i) { return yAxis(i) })\n  .attr(\"y2\", function(d, i) { return yAxis(i + 2)-2 })\n  .style(\"stroke\",\"black\")\n  .style(\"stroke-width\",\"1\")\n};","style":"/* R2D3 Source File:  /Library/Frameworks/R.framework/Versions/3.5/Resources/library/iBreakDown/breakDownD3.css */\n.d3-tip {\n    line-height: 1.1;\n    padding: 6px;\n    background: #00000080;\n    color: #fff;\n    border-radius: 0px;\n    font-size: 14px;\n    font-family: 'Roboto Condensed', sans-serif;\n  }\n\n  /* Creates a small triangle extender for the tooltip */\n  .d3-tip:after {\n    box-sizing: border-box;\n    display: inline;\n    font-size: 10px;\n    width: 100%;\n    line-height: 1;\n    color: rgba(0, 0, 0, 0.8);\n    content: \"\\25BC\";\n    position: absolute;\n    text-align: center;\n  }\n\n  /* Style northward tooltips specifically */\n  .d3-tip.n:after {\n    margin: -2px 0 0 0;\n    top: 100%;\n    left: 0;\n  }","version":4,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#data-for-titanic-survival">Data for Titanic survival</a></li>
      <li><a href="#model-for-titanic-survival">Model for Titanic survival</a></li>
      <li><a href="#explainer-for-titanic-survival">Explainer for Titanic survival</a></li>
      <li>
<a href="#break-down-plot-with-d3">Break Down plot with D3</a><ul class="nav nav-pills nav-stacked">
<li><a href="#calculate-variable-attributions">Calculate variable attributions</a></li>
      <li><a href="#plot-attributions-with-ggplot2">Plot attributions with <code>ggplot2</code></a></li>
      <li><a href="#plot-attributions-with-d3">Plot attributions with <code>D3</code></a></li>
      <li><a href="#calculate-uncertainty-for-variable-attributions">Calculate uncertainty for variable attributions</a></li>
      <li><a href="#show-only-top-features">Show only top features</a></li>
      <li><a href="#force-ox-axis-to-be-from-0-to-1">Force OX axis to be from 0 to 1</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Przemyslaw Biecek, Alicja Gosiewska.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
